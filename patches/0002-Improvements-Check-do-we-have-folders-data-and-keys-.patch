From ea5cf39c0d661bfc78c91f54e3f32fd3e2fb75ac Mon Sep 17 00:00:00 2001
From: radomir-sebek <rasho.ieee@gmail.com>
Date: Fri, 27 Apr 2018 09:39:30 +0200
Subject: [PATCH 02/22] [Improvements] Check do we have folders "data" and
 "keys" present (#88)

---
 install.sh           |  1 +
 modules/Utilities.js | 23 +++++++++++++++++++++++
 ot-node.js           |  8 ++++++++
 3 files changed, 32 insertions(+)

diff --git a/install.sh b/install.sh
index 191ea7e..979a573 100644
--- a/install.sh
+++ b/install.sh
@@ -23,6 +23,7 @@ sudo apt-get install git
 
 git clone -b master https://github.com/OriginTrail/ot-node.git
 cd ot-node
+mkdir keys data &> /dev/null
 cp .env.example .env
 
 npm install
diff --git a/modules/Utilities.js b/modules/Utilities.js
index b146241..4eecd20 100644
--- a/modules/Utilities.js
+++ b/modules/Utilities.js
@@ -321,6 +321,29 @@ class Utilities {
 
         return sortedObj;
     }
+
+    /**
+     * Checks for expected ot-node directory structure
+     * @returns {void}
+     */
+    static checkOtNodeDirStructure() {
+        const log = this.getLogger();
+        try {
+            if (!fs.existsSync(`${__dirname}/../keys`)) {
+                fs.mkdirSync(`${__dirname}/../keys`);
+            }
+        } catch (error) {
+            log.warn('Failed to create folder named keys');
+        }
+
+        try {
+            if (!fs.existsSync(`${__dirname}/../data`)) {
+                fs.mkdirSync(`${__dirname}/../data`);
+            }
+        } catch (error) {
+            log.warn('Failed to create folder named data');
+        }
+    }
 }
 
 module.exports = Utilities;
diff --git a/ot-node.js b/ot-node.js
index 1725dec..7b5130e 100644
--- a/ot-node.js
+++ b/ot-node.js
@@ -39,6 +39,14 @@ class OTNode {
      * OriginTrail node system bootstrap function
      */
     bootstrap() {
+        // Checking root folder stucture
+        try {
+            Utilities.checkOtNodeDirStructure();
+            log.info('ot-node folder structure checked');
+        } catch (err) {
+            console.log(err);
+        }
+
         // sync models
         Storage.models = deasync(models.sequelize.sync()).models;
 
-- 
2.13.5 (Apple Git-94)

